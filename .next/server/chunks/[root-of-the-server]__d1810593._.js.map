{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///home/hardik/rajashai/lib/mongodb.ts"],"sourcesContent":["import mongoose from 'mongoose';\n\nconst MONGODB_URI = process.env.MONGODB_URI as string;\nif (!MONGODB_URI) {\n  throw new Error(\"MONGODB_URI is not set\");\n}\n\n// Global cache to survive hot-reloads in dev\ndeclare global {\n  // eslint-disable-next-line no-var\n  var _mongoose: { conn: typeof mongoose | null, promise: Promise<typeof mongoose> | null } | undefined;\n}\n\nlet cached = global._mongoose;\nif (!cached) cached = global._mongoose = { conn: null, promise: null };\n\nexport async function dbConnect() {\n  if (cached!.conn) return cached!.conn;\n\n  if (!cached!.promise) {\n    cached!.promise = mongoose.connect(MONGODB_URI).then((m) => m);\n  }\n  cached!.conn = await cached!.promise;\n  return cached!.conn;\n}\n"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAC3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MAAM;AAClB;AAQA,IAAI,SAAS,OAAO,SAAS;AAC7B,IAAI,CAAC,QAAQ,SAAS,OAAO,SAAS,GAAG;IAAE,MAAM;IAAM,SAAS;AAAK;AAE9D,eAAe;IACpB,IAAI,OAAQ,IAAI,EAAE,OAAO,OAAQ,IAAI;IAErC,IAAI,CAAC,OAAQ,OAAO,EAAE;QACpB,OAAQ,OAAO,GAAG,yGAAA,CAAA,UAAQ,CAAC,OAAO,CAAC,aAAa,IAAI,CAAC,CAAC,IAAM;IAC9D;IACA,OAAQ,IAAI,GAAG,MAAM,OAAQ,OAAO;IACpC,OAAO,OAAQ,IAAI;AACrB","debugId":null}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///home/hardik/rajashai/models/Round.ts"],"sourcesContent":["// models/Round.ts\nimport { Schema, Document, models, model } from 'mongoose';\n\nexport type RoundStatus =\n  | 'READY'\n  | 'OPENING_PUBLISHED'   // legacy\n  | 'DAY_PUBLISHED'       // legacy\n  | 'CLOSED';             // legacy\n\n// NEW: per-line statuses\nexport type LineStatus = 'READY' | 'OPEN_PUBLISHED' | 'CLOSED';\n\nexport interface RoundCore {\n  roundId: string;\n  sessionDate: string;     // 'YYYY-MM-DD'\n\n  // OLD (keep)\n  dayTime: string;         // used to be one time\n  nightTime: string;\n\n  // NEW times (more explicit, can be same as old ones)\n  dayOpenTime?: string;\n  dayCloseTime?: string;\n  nightOpenTime?: string;\n  nightCloseTime?: string;\n\n  // DAY line (opening/closing)\n  dayOpenPanna?: string;\n  dayOpenDigit?: number;\n  dayClosePanna?: string;\n  dayCloseDigit?: number;\n  dayJodi?: string;\n  dayLineStatus?: LineStatus;\n\n  // NIGHT line (opening/closing)\n  nightOpenPanna?: string;\n  nightOpenDigit?: number;\n  nightClosePanna?: string;\n  nightCloseDigit?: number;\n  nightJodi?: string;\n  nightLineStatus?: LineStatus;\n\n  // legacy fields:\n  dayPanna?: string;\n  dayDigit?: number;\n  nightPanna?: string;\n  nightDigit?: number;\n  jodi?: string;\n\n  status: RoundStatus;\n  createdAt: Date;\n  updatedAt: Date;\n}\nexport interface IRound extends Document, RoundCore {}\n\nconst timeHHmm = /^([01]\\d|2[0-3]):[0-5]\\d$/;\nconst panna3 = /^\\d{3}$/;\nconst jodi2  = /^\\d{2}$/;\n\nconst RoundSchema = new Schema<IRound>({\n  roundId: { type: String, required: true, unique: true },\n  sessionDate: { type: String, required: true, match: /^\\d{4}-\\d{2}-\\d{2}$/ },\n\n  // old\n  dayTime:   { type: String, required: true, match: timeHHmm },\n  nightTime: { type: String, required: true, match: timeHHmm },\n\n  // new optional times\n  dayOpenTime:   { type: String, match: timeHHmm, default: undefined },\n  dayCloseTime:  { type: String, match: timeHHmm, default: undefined },\n  nightOpenTime: { type: String, match: timeHHmm, default: undefined },\n  nightCloseTime:{ type: String, match: timeHHmm, default: undefined },\n\n  // DAY line\n  dayOpenPanna:  { type: String, match: panna3, default: undefined },\n  dayOpenDigit:  { type: Number, min: 0, max: 9, default: undefined },\n  dayClosePanna: { type: String, match: panna3, default: undefined },\n  dayCloseDigit: { type: Number, min: 0, max: 9, default: undefined },\n  dayJodi:       { type: String, match: jodi2, default: undefined },\n  dayLineStatus: { type: String, enum: ['READY','OPEN_PUBLISHED','CLOSED'], default: 'READY' },\n\n  // NIGHT line\n  nightOpenPanna:  { type: String, match: panna3, default: undefined },\n  nightOpenDigit:  { type: Number, min: 0, max: 9, default: undefined },\n  nightClosePanna: { type: String, match: panna3, default: undefined },\n  nightCloseDigit: { type: Number, min: 0, max: 9, default: undefined },\n  nightJodi:       { type: String, match: jodi2, default: undefined },\n  nightLineStatus: { type: String, enum: ['READY','OPEN_PUBLISHED','CLOSED'], default: 'READY' },\n\n  // legacy\n  dayPanna:   { type: String, match: panna3, default: undefined },\n  dayDigit:   { type: Number, min: 0, max: 9, default: undefined },\n  nightPanna: { type: String, match: panna3, default: undefined },\n  nightDigit: { type: Number, min: 0, max: 9, default: undefined },\n\n  jodi: { type: String, match: jodi2, default: undefined },\n\n  status: {\n    type: String,\n    enum: ['READY','OPENING_PUBLISHED','DAY_PUBLISHED','CLOSED'],\n    default: 'READY',\n    required: true\n  }\n}, { timestamps: true });\n\nRoundSchema.index({ sessionDate: 1 }, { unique: true });\n\n// keep your legacy pre-validate but extend it\nRoundSchema.pre('validate', function (next) {\n  // legacy names to new names\n  // @ts-ignore\n  const openingTime = (this as any).openingTime;\n  // @ts-ignore\n  const closingTime = (this as any).closingTime;\n\n  // if new times missing, fall back to old ones\n  if (!this.dayOpenTime)  this.dayOpenTime  = this.dayTime || openingTime;\n  if (!this.dayCloseTime) this.dayCloseTime = this.dayTime || closingTime;\n  if (!this.nightOpenTime)  this.nightOpenTime  = this.nightTime || openingTime;\n  if (!this.nightCloseTime) this.nightCloseTime = this.nightTime || closingTime;\n\n  // legacy result fields\n  // @ts-ignore\n  const openingPanna = (this as any).openingPanna;\n  // @ts-ignore\n  const openingDigit = (this as any).openingDigit;\n  // @ts-ignore\n  const closingPanna = (this as any).closingPanna;\n  // @ts-ignore\n  const closingDigit = (this as any).closingDigit;\n\n  // map old day → dayOpen\n  if (!this.dayOpenPanna && (this.dayPanna || openingPanna)) {\n    this.dayOpenPanna = this.dayPanna || openingPanna;\n  }\n  if (this.dayOpenDigit == null && (this.dayDigit != null || openingDigit != null)) {\n    this.dayOpenDigit = this.dayDigit ?? openingDigit;\n  }\n\n  // map old night → nightOpen\n  if (!this.nightOpenPanna && (this.nightPanna || closingPanna)) {\n    this.nightOpenPanna = this.nightPanna || closingPanna;\n  }\n  if (this.nightOpenDigit == null && (this.nightDigit != null || closingDigit != null)) {\n    this.nightOpenDigit = this.nightDigit ?? closingDigit;\n  }\n\n  next();\n});\n\nexport default models.Round || model<IRound>('Round', RoundSchema);\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///home/hardik/rajashai/app/api/result/latest/route.ts"],"sourcesContent":["// app/api/result/latest/route.ts\nimport { NextResponse } from 'next/server';\nimport { dbConnect } from '@/lib/mongodb';\nimport Round from '@/models/Round';\n\nexport async function GET(req: Request) {\n  await dbConnect();\n\n  const url = new URL(req.url);\n  const side = url.searchParams.get('side'); // 'day' | 'night' | null\n\n  // latest round by date (and createdAt as tiebreaker)\n  const round = await Round.findOne({})\n    .sort({ sessionDate: -1, createdAt: -1 })\n    .lean<any>();\n\n  if (!round) {\n    return NextResponse.json(\n      { ok: false, error: 'No round', status: 'READY' },\n      { status: 404 }\n    );\n  }\n\n  // ----- DAY mapping -----\n  // prefer new fields, then fall back to legacy\n  const dayOpenPanna  = round.dayOpenPanna  ?? round.dayPanna ?? null;\n  const dayOpenDigit  = round.dayOpenDigit  ?? round.dayDigit ?? null;\n  const dayClosePanna = round.dayClosePanna ?? null;\n  const dayCloseDigit = round.dayCloseDigit ?? null;\n\n  const haveDayOpen  = dayOpenDigit  !== null && dayOpenDigit  !== undefined;\n  const haveDayClose = dayCloseDigit !== null && dayCloseDigit !== undefined;\n\n  // if both present, use stored dayJodi else derive from digits\n  const dayJodi =\n    haveDayOpen && haveDayClose\n      ? (round.dayJodi ?? `${dayOpenDigit}${dayCloseDigit}`)\n      : null;\n\n  const dayLineStatus: 'READY' | 'OPEN_PUBLISHED' | 'CLOSED' =\n    round.dayLineStatus\n      ? round.dayLineStatus\n      : haveDayOpen\n        ? (haveDayClose ? 'CLOSED' : 'OPEN_PUBLISHED')\n        : 'READY';\n\n  // ----- NIGHT mapping -----\n  const nightOpenPanna  = round.nightOpenPanna  ?? round.nightPanna ?? null;\n  const nightOpenDigit  = round.nightOpenDigit  ?? round.nightDigit ?? null;\n  const nightClosePanna = round.nightClosePanna ?? null;\n  const nightCloseDigit = round.nightCloseDigit ?? null;\n\n  const haveNightOpen  = nightOpenDigit  !== null && nightOpenDigit  !== undefined;\n  const haveNightClose = nightCloseDigit !== null && nightCloseDigit !== undefined;\n\n  const nightJodi =\n    haveNightOpen && haveNightClose\n      ? (round.nightJodi ?? `${nightOpenDigit}${nightCloseDigit}`)\n      : null;\n\n  const nightLineStatus: 'READY' | 'OPEN_PUBLISHED' | 'CLOSED' =\n    round.nightLineStatus\n      ? round.nightLineStatus\n      : haveNightOpen\n        ? (haveNightClose ? 'CLOSED' : 'OPEN_PUBLISHED')\n        : 'READY';\n\n  // pick which side to “surface” to the old client\n  if (side === 'night') {\n    // NIGHT view\n    return NextResponse.json({\n      ok: true,\n      sessionDate: round.sessionDate,\n      status: nightLineStatus,          // 'READY' | 'OPEN_PUBLISHED' | 'CLOSED'\n      jodi: nightJodi,\n      // map to old names so your <ResultRibbon ... nightPanna= ... /> works\n      dayPanna: null,\n      dayDigit: null,\n      nightPanna: nightOpenPanna,\n      nightDigit: nightOpenDigit,\n      formatted: `Night ${nightOpenPanna ?? '--'}${nightClosePanna ? ' / ' + nightClosePanna : ''}`\n    });\n  }\n\n  // default = DAY view\n  return NextResponse.json({\n    ok: true,\n    sessionDate: round.sessionDate,\n    status: dayLineStatus,              // 'READY' | 'OPEN_PUBLISHED' | 'CLOSED'\n    jodi: dayJodi,\n    // expose day opening under old names so your page sees it:\n    dayPanna: dayOpenPanna,\n    dayDigit: dayOpenDigit,\n    // keep night here too because your component passes them through\n    nightPanna: nightOpenPanna,\n    nightDigit: nightOpenDigit,\n    formatted: `Day ${dayOpenPanna ?? '--'}${dayClosePanna ? ' / ' + dayClosePanna : ''}`\n  });\n}\n"],"names":[],"mappings":"AAAA,iCAAiC;;;;AACjC;AACA;AACA;;;;AAEO,eAAe,IAAI,GAAY;IACpC,MAAM,CAAA,GAAA,gHAAA,CAAA,YAAS,AAAD;IAEd,MAAM,MAAM,IAAI,IAAI,IAAI,GAAG;IAC3B,MAAM,OAAO,IAAI,YAAY,CAAC,GAAG,CAAC,SAAS,yBAAyB;IAEpE,qDAAqD;IACrD,MAAM,QAAQ,MAAM,iHAAA,CAAA,UAAK,CAAC,OAAO,CAAC,CAAC,GAChC,IAAI,CAAC;QAAE,aAAa,CAAC;QAAG,WAAW,CAAC;IAAE,GACtC,IAAI;IAEP,IAAI,CAAC,OAAO;QACV,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,IAAI;YAAO,OAAO;YAAY,QAAQ;QAAQ,GAChD;YAAE,QAAQ;QAAI;IAElB;IAEA,0BAA0B;IAC1B,8CAA8C;IAC9C,MAAM,eAAgB,MAAM,YAAY,IAAK,MAAM,QAAQ,IAAI;IAC/D,MAAM,eAAgB,MAAM,YAAY,IAAK,MAAM,QAAQ,IAAI;IAC/D,MAAM,gBAAgB,MAAM,aAAa,IAAI;IAC7C,MAAM,gBAAgB,MAAM,aAAa,IAAI;IAE7C,MAAM,cAAe,iBAAkB,QAAQ,iBAAkB;IACjE,MAAM,eAAe,kBAAkB,QAAQ,kBAAkB;IAEjE,8DAA8D;IAC9D,MAAM,UACJ,eAAe,eACV,MAAM,OAAO,IAAI,GAAG,eAAe,eAAe,GACnD;IAEN,MAAM,gBACJ,MAAM,aAAa,GACf,MAAM,aAAa,GACnB,cACG,eAAe,WAAW,mBAC3B;IAER,4BAA4B;IAC5B,MAAM,iBAAkB,MAAM,cAAc,IAAK,MAAM,UAAU,IAAI;IACrE,MAAM,iBAAkB,MAAM,cAAc,IAAK,MAAM,UAAU,IAAI;IACrE,MAAM,kBAAkB,MAAM,eAAe,IAAI;IACjD,MAAM,kBAAkB,MAAM,eAAe,IAAI;IAEjD,MAAM,gBAAiB,mBAAoB,QAAQ,mBAAoB;IACvE,MAAM,iBAAiB,oBAAoB,QAAQ,oBAAoB;IAEvE,MAAM,YACJ,iBAAiB,iBACZ,MAAM,SAAS,IAAI,GAAG,iBAAiB,iBAAiB,GACzD;IAEN,MAAM,kBACJ,MAAM,eAAe,GACjB,MAAM,eAAe,GACrB,gBACG,iBAAiB,WAAW,mBAC7B;IAER,iDAAiD;IACjD,IAAI,SAAS,SAAS;QACpB,aAAa;QACb,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,IAAI;YACJ,aAAa,MAAM,WAAW;YAC9B,QAAQ;YACR,MAAM;YACN,sEAAsE;YACtE,UAAU;YACV,UAAU;YACV,YAAY;YACZ,YAAY;YACZ,WAAW,CAAC,MAAM,EAAE,kBAAkB,OAAO,kBAAkB,QAAQ,kBAAkB,IAAI;QAC/F;IACF;IAEA,qBAAqB;IACrB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QACvB,IAAI;QACJ,aAAa,MAAM,WAAW;QAC9B,QAAQ;QACR,MAAM;QACN,2DAA2D;QAC3D,UAAU;QACV,UAAU;QACV,iEAAiE;QACjE,YAAY;QACZ,YAAY;QACZ,WAAW,CAAC,IAAI,EAAE,gBAAgB,OAAO,gBAAgB,QAAQ,gBAAgB,IAAI;IACvF;AACF","debugId":null}}]
}