{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///home/hardik/rajashai/lib/mongodb.ts"],"sourcesContent":["import mongoose from 'mongoose';\n\nconst MONGODB_URI = process.env.MONGODB_URI as string;\nif (!MONGODB_URI) {\n  throw new Error(\"MONGODB_URI is not set\");\n}\n\n// Global cache to survive hot-reloads in dev\ndeclare global {\n  // eslint-disable-next-line no-var\n  var _mongoose: { conn: typeof mongoose | null, promise: Promise<typeof mongoose> | null } | undefined;\n}\n\nlet cached = global._mongoose;\nif (!cached) cached = global._mongoose = { conn: null, promise: null };\n\nexport async function dbConnect() {\n  if (cached!.conn) return cached!.conn;\n\n  if (!cached!.promise) {\n    cached!.promise = mongoose.connect(MONGODB_URI).then((m) => m);\n  }\n  cached!.conn = await cached!.promise;\n  return cached!.conn;\n}\n"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAC3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MAAM;AAClB;AAQA,IAAI,SAAS,OAAO,SAAS;AAC7B,IAAI,CAAC,QAAQ,SAAS,OAAO,SAAS,GAAG;IAAE,MAAM;IAAM,SAAS;AAAK;AAE9D,eAAe;IACpB,IAAI,OAAQ,IAAI,EAAE,OAAO,OAAQ,IAAI;IAErC,IAAI,CAAC,OAAQ,OAAO,EAAE;QACpB,OAAQ,OAAO,GAAG,yGAAA,CAAA,UAAQ,CAAC,OAAO,CAAC,aAAa,IAAI,CAAC,CAAC,IAAM;IAC9D;IACA,OAAQ,IAAI,GAAG,MAAM,OAAQ,OAAO;IACpC,OAAO,OAAQ,IAAI;AACrB","debugId":null}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///home/hardik/rajashai/models/Round.ts"],"sourcesContent":["// models/Round.ts\nimport { Schema, Document, models, model } from 'mongoose';\n\nexport type RoundStatus =\n  | 'READY'\n  | 'OPENING_PUBLISHED'   // legacy\n  | 'DAY_PUBLISHED'       // legacy\n  | 'CLOSED';             // legacy\n\n// NEW: per-line statuses\nexport type LineStatus = 'READY' | 'OPEN_PUBLISHED' | 'CLOSED';\n\nexport interface RoundCore {\n  roundId: string;\n  sessionDate: string;     // 'YYYY-MM-DD'\n\n  // OLD (keep)\n  dayTime: string;         // used to be one time\n  nightTime: string;\n\n  // NEW times (more explicit, can be same as old ones)\n  dayOpenTime?: string;\n  dayCloseTime?: string;\n  nightOpenTime?: string;\n  nightCloseTime?: string;\n\n  // DAY line (opening/closing)\n  dayOpenPanna?: string;\n  dayOpenDigit?: number;\n  dayClosePanna?: string;\n  dayCloseDigit?: number;\n  dayJodi?: string;\n  dayLineStatus?: LineStatus;\n\n  // NIGHT line (opening/closing)\n  nightOpenPanna?: string;\n  nightOpenDigit?: number;\n  nightClosePanna?: string;\n  nightCloseDigit?: number;\n  nightJodi?: string;\n  nightLineStatus?: LineStatus;\n\n  // legacy fields:\n  dayPanna?: string;\n  dayDigit?: number;\n  nightPanna?: string;\n  nightDigit?: number;\n  jodi?: string;\n\n  status: RoundStatus;\n  createdAt: Date;\n  updatedAt: Date;\n}\nexport interface IRound extends Document, RoundCore {}\n\nconst timeHHmm = /^([01]\\d|2[0-3]):[0-5]\\d$/;\nconst panna3 = /^\\d{3}$/;\nconst jodi2  = /^\\d{2}$/;\n\nconst RoundSchema = new Schema<IRound>({\n  roundId: { type: String, required: true, unique: true },\n  sessionDate: { type: String, required: true, match: /^\\d{4}-\\d{2}-\\d{2}$/ },\n\n  // old\n  dayTime:   { type: String, required: true, match: timeHHmm },\n  nightTime: { type: String, required: true, match: timeHHmm },\n\n  // new optional times\n  dayOpenTime:   { type: String, match: timeHHmm, default: undefined },\n  dayCloseTime:  { type: String, match: timeHHmm, default: undefined },\n  nightOpenTime: { type: String, match: timeHHmm, default: undefined },\n  nightCloseTime:{ type: String, match: timeHHmm, default: undefined },\n\n  // DAY line\n  dayOpenPanna:  { type: String, match: panna3, default: undefined },\n  dayOpenDigit:  { type: Number, min: 0, max: 9, default: undefined },\n  dayClosePanna: { type: String, match: panna3, default: undefined },\n  dayCloseDigit: { type: Number, min: 0, max: 9, default: undefined },\n  dayJodi:       { type: String, match: jodi2, default: undefined },\n  dayLineStatus: { type: String, enum: ['READY','OPEN_PUBLISHED','CLOSED'], default: 'READY' },\n\n  // NIGHT line\n  nightOpenPanna:  { type: String, match: panna3, default: undefined },\n  nightOpenDigit:  { type: Number, min: 0, max: 9, default: undefined },\n  nightClosePanna: { type: String, match: panna3, default: undefined },\n  nightCloseDigit: { type: Number, min: 0, max: 9, default: undefined },\n  nightJodi:       { type: String, match: jodi2, default: undefined },\n  nightLineStatus: { type: String, enum: ['READY','OPEN_PUBLISHED','CLOSED'], default: 'READY' },\n\n  // legacy\n  dayPanna:   { type: String, match: panna3, default: undefined },\n  dayDigit:   { type: Number, min: 0, max: 9, default: undefined },\n  nightPanna: { type: String, match: panna3, default: undefined },\n  nightDigit: { type: Number, min: 0, max: 9, default: undefined },\n\n  jodi: { type: String, match: jodi2, default: undefined },\n\n  status: {\n    type: String,\n    enum: ['READY','OPENING_PUBLISHED','DAY_PUBLISHED','CLOSED'],\n    default: 'READY',\n    required: true\n  }\n}, { timestamps: true });\n\nRoundSchema.index({ sessionDate: 1 }, { unique: true });\n\n// keep your legacy pre-validate but extend it\nRoundSchema.pre('validate', function (next) {\n  // legacy names to new names\n  // @ts-ignore\n  const openingTime = (this as any).openingTime;\n  // @ts-ignore\n  const closingTime = (this as any).closingTime;\n\n  // if new times missing, fall back to old ones\n  if (!this.dayOpenTime)  this.dayOpenTime  = this.dayTime || openingTime;\n  if (!this.dayCloseTime) this.dayCloseTime = this.dayTime || closingTime;\n  if (!this.nightOpenTime)  this.nightOpenTime  = this.nightTime || openingTime;\n  if (!this.nightCloseTime) this.nightCloseTime = this.nightTime || closingTime;\n\n  // legacy result fields\n  // @ts-ignore\n  const openingPanna = (this as any).openingPanna;\n  // @ts-ignore\n  const openingDigit = (this as any).openingDigit;\n  // @ts-ignore\n  const closingPanna = (this as any).closingPanna;\n  // @ts-ignore\n  const closingDigit = (this as any).closingDigit;\n\n  // map old day ‚Üí dayOpen\n  if (!this.dayOpenPanna && (this.dayPanna || openingPanna)) {\n    this.dayOpenPanna = this.dayPanna || openingPanna;\n  }\n  if (this.dayOpenDigit == null && (this.dayDigit != null || openingDigit != null)) {\n    this.dayOpenDigit = this.dayDigit ?? openingDigit;\n  }\n\n  // map old night ‚Üí nightOpen\n  if (!this.nightOpenPanna && (this.nightPanna || closingPanna)) {\n    this.nightOpenPanna = this.nightPanna || closingPanna;\n  }\n  if (this.nightOpenDigit == null && (this.nightDigit != null || closingDigit != null)) {\n    this.nightOpenDigit = this.nightDigit ?? closingDigit;\n  }\n\n  next();\n});\n\nexport default models.Round || model<IRound>('Round', RoundSchema);\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///home/hardik/rajashai/models/Bet.ts"],"sourcesContent":["// models/Bet.ts\nimport { Schema, Document, models, model, Types } from 'mongoose';\n\nexport type BetType =\n  | 'SINGLE_DAY'\n  | 'SINGLE_NIGHT'\n  | 'JODI'\n  | 'PANNA_DAY'\n  | 'PANNA_NIGHT';\n\nexport interface BetCore {\n  guestId: string;\n  round: Types.ObjectId;\n  type: BetType;\n  number: string;       // '0'..'9' | '00'..'99' | '000'..'999'\n  stakeTokens?: number;\n  createdAt: Date;\n  updatedAt: Date;\n}\nexport interface IBet extends Document, BetCore {}\n\nconst BetSchema = new Schema<IBet>({\n  guestId: { type: String, required: true, index: true },\n  round:   { type: Schema.Types.ObjectId, ref: 'Round', required: true, index: true },\n  type: {\n    type: String,\n    enum: ['SINGLE_DAY', 'SINGLE_NIGHT', 'JODI', 'PANNA_DAY', 'PANNA_NIGHT'],\n    required: true, index: true\n  },\n  number: {\n    type: String,\n    required: true,\n    validate: {\n      validator(this: IBet, v: string) {\n        switch (this.type) {\n          case 'SINGLE_DAY':\n          case 'SINGLE_NIGHT':\n            return /^[0-9]$/.test(v);\n          case 'JODI':\n            return /^\\d{2}$/.test(v);\n          case 'PANNA_DAY':\n          case 'PANNA_NIGHT':\n            return /^\\d{3}$/.test(v);\n          default:\n            return false;\n        }\n      },\n      message: 'Invalid number format for the selected bet type.'\n    }\n  },\n  stakeTokens: { type: Number, default: 1, min: 0 }\n}, { timestamps: true });\n\nBetSchema.index({ round: 1, type: 1 });\nBetSchema.index({ round: 1, guestId: 1 });\n\nexport default models.Bet || model<IBet>('Bet', BetSchema);\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;AAChB;;AAoBA,MAAM,YAAY,IAAI,yGAAA,CAAA,SAAM,CAAO;IACjC,SAAS;QAAE,MAAM;QAAQ,UAAU;QAAM,OAAO;IAAK;IACrD,OAAS;QAAE,MAAM,yGAAA,CAAA,SAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAS,UAAU;QAAM,OAAO;IAAK;IAClF,MAAM;QACJ,MAAM;QACN,MAAM;YAAC;YAAc;YAAgB;YAAQ;YAAa;SAAc;QACxE,UAAU;QAAM,OAAO;IACzB;IACA,QAAQ;QACN,MAAM;QACN,UAAU;QACV,UAAU;YACR,WAAsB,CAAS;gBAC7B,OAAQ,IAAI,CAAC,IAAI;oBACf,KAAK;oBACL,KAAK;wBACH,OAAO,UAAU,IAAI,CAAC;oBACxB,KAAK;wBACH,OAAO,UAAU,IAAI,CAAC;oBACxB,KAAK;oBACL,KAAK;wBACH,OAAO,UAAU,IAAI,CAAC;oBACxB;wBACE,OAAO;gBACX;YACF;YACA,SAAS;QACX;IACF;IACA,aAAa;QAAE,MAAM;QAAQ,SAAS;QAAG,KAAK;IAAE;AAClD,GAAG;IAAE,YAAY;AAAK;AAEtB,UAAU,KAAK,CAAC;IAAE,OAAO;IAAG,MAAM;AAAE;AACpC,UAAU,KAAK,CAAC;IAAE,OAAO;IAAG,SAAS;AAAE;uCAExB,yGAAA,CAAA,SAAM,CAAC,GAAG,IAAI,CAAA,GAAA,yGAAA,CAAA,QAAK,AAAD,EAAQ,OAAO","debugId":null}},
    {"offset": {"line": 387, "column": 0}, "map": {"version":3,"sources":["file:///home/hardik/rajashai/utils/helpers.ts"],"sourcesContent":["// utils/helpers.ts\n\n/**\n * Given a panna (3-digit string like \"160\"), return the derived digit.\n * Rule: sum of digits % 10\n */\nexport function digitFromPanna(panna: string): number {\n  if (!/^\\d{3}$/.test(panna)) {\n    throw new Error(`Invalid panna: ${panna}`);\n  }\n  const sum = [...panna].reduce((acc, ch) => acc + Number(ch), 0);\n  return sum % 10;\n}\n\n/**\n * Generate a random panna (string \"000\"..\"999\").\n * Demo-only (uses Math.random, not cryptographically fair).\n */\nexport function randomPanna(): string {\n  return String(Math.floor(Math.random() * 1000)).padStart(3, '0');\n}\n\n/**\n * Derive the Jodi (two-digit string) from opening + closing digits.\n * If closingDigit is missing (opening-only stage), returns undefined.\n */\nexport function deriveJodi(openingDigit: number, closingDigit?: number): string | undefined {\n  if (closingDigit === undefined) return undefined;\n  return `${openingDigit}${closingDigit}`;\n}\n\n/**\n * Format the final result line:\n * (OpeningPanna) OpeningDigit ‚ùò ClosingDigit (ClosingPanna)\n * Example: (160) 7 | 9 (135)\n */\nexport function formatResult(\n  openingPanna?: string,\n  openingDigit?: number,\n  closingDigit?: number,\n  closingPanna?: string\n): string {\n  if (!openingPanna || openingDigit === undefined) return '';\n  if (!closingPanna || closingDigit === undefined) {\n    // Only opening published\n    return `(${openingPanna}) ${openingDigit} | ?`;\n  }\n  return `(${openingPanna}) ${openingDigit} | ${closingDigit} (${closingPanna})`;\n}\n\n/**\n * Generate a compact roundId based on timestamp\n * Format: yyyyMMddHHmmss\n */\nexport function generateRoundId(): string {\n  const d = new Date();\n  const s = d.toISOString().replace(/[-:T]/g, '').slice(0, 14);\n  return s; // e.g. \"20251001123456\"\n}\n"],"names":[],"mappings":"AAAA,mBAAmB;AAEnB;;;CAGC;;;;;;;AACM,SAAS,eAAe,KAAa;IAC1C,IAAI,CAAC,UAAU,IAAI,CAAC,QAAQ;QAC1B,MAAM,IAAI,MAAM,CAAC,eAAe,EAAE,OAAO;IAC3C;IACA,MAAM,MAAM;WAAI;KAAM,CAAC,MAAM,CAAC,CAAC,KAAK,KAAO,MAAM,OAAO,KAAK;IAC7D,OAAO,MAAM;AACf;AAMO,SAAS;IACd,OAAO,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,OAAO,QAAQ,CAAC,GAAG;AAC9D;AAMO,SAAS,WAAW,YAAoB,EAAE,YAAqB;IACpE,IAAI,iBAAiB,WAAW,OAAO;IACvC,OAAO,GAAG,eAAe,cAAc;AACzC;AAOO,SAAS,aACd,YAAqB,EACrB,YAAqB,EACrB,YAAqB,EACrB,YAAqB;IAErB,IAAI,CAAC,gBAAgB,iBAAiB,WAAW,OAAO;IACxD,IAAI,CAAC,gBAAgB,iBAAiB,WAAW;QAC/C,yBAAyB;QACzB,OAAO,CAAC,CAAC,EAAE,aAAa,EAAE,EAAE,aAAa,IAAI,CAAC;IAChD;IACA,OAAO,CAAC,CAAC,EAAE,aAAa,EAAE,EAAE,aAAa,GAAG,EAAE,aAAa,EAAE,EAAE,aAAa,CAAC,CAAC;AAChF;AAMO,SAAS;IACd,MAAM,IAAI,IAAI;IACd,MAAM,IAAI,EAAE,WAAW,GAAG,OAAO,CAAC,UAAU,IAAI,KAAK,CAAC,GAAG;IACzD,OAAO,GAAG,wBAAwB;AACpC","debugId":null}},
    {"offset": {"line": 431, "column": 0}, "map": {"version":3,"sources":["file:///home/hardik/rajashai/app/api/admin/rounds/%5BsessionDate%5D/route.ts"],"sourcesContent":["// app/api/admin/rounds/[sessionDate]/route.ts\nimport { NextResponse } from 'next/server';\nimport { dbConnect } from '@/lib/mongodb';\nimport Round from '@/models/Round';\nimport Bet from '@/models/Bet'; \nimport { digitFromPanna, deriveJodi } from '@/utils/helpers';\n\nconst pad3 = (v: any) =>\n  String(v ?? '')\n    .replace(/\\D/g, '')\n    .slice(0, 3)\n    .padStart(3, '0');\n\nconst hhmm = /^([01]\\d|2[0-3]):[0-5]\\d$/;\n\nfunction extractSessionDate(req: Request) {\n  const url = new URL(req.url);\n  const rawParam = decodeURIComponent(url.pathname.split('/').pop() || '');\n  const raw = rawParam.normalize().trim();\n  const sessionDate = raw.replace(/[^\\d-]/g, '');\n  if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(sessionDate)) return null;\n  return sessionDate;\n}\n\nexport async function PATCH(req: Request) {\n  const sessionDate = extractSessionDate(req);\n  if (!sessionDate) {\n    return NextResponse.json({ ok: false, error: 'Bad sessionDate in URL' }, { status: 400 });\n  }\n\n  const body = (await req.json().catch(() => ({} as any))) as any;\n\n  await dbConnect();\n  let round = await Round.findOne({ sessionDate });\n\n  // create round if missing\n  if (!round) {\n    round = new Round({\n      roundId: 'R-' + sessionDate.replace(/-/g, ''),\n      sessionDate,\n      dayTime: '10:00',\n      nightTime: '22:00',\n      status: 'READY',\n    });\n  }\n\n  // ---------- NEW: time fields ----------\n  if (typeof body.dayOpenTime === 'string' && hhmm.test(body.dayOpenTime)) {\n    round.dayOpenTime = body.dayOpenTime;\n  }\n  if (typeof body.dayCloseTime === 'string' && hhmm.test(body.dayCloseTime)) {\n    round.dayCloseTime = body.dayCloseTime;\n  }\n  if (typeof body.nightOpenTime === 'string' && hhmm.test(body.nightOpenTime)) {\n    round.nightOpenTime = body.nightOpenTime;\n  }\n  if (typeof body.nightCloseTime === 'string' && hhmm.test(body.nightCloseTime)) {\n    round.nightCloseTime = body.nightCloseTime;\n  }\n\n  // figure out what we‚Äôre setting (same as before)\n  const setDayLegacy   = 'dayPanna' in body;\n  const setNightLegacy = 'nightPanna' in body;\n  const setDayOpen     = 'dayOpenPanna' in body;\n  const setDayClose    = 'dayClosePanna' in body;\n  const setNightOpen   = 'nightOpenPanna' in body;\n  const setNightClose  = 'nightClosePanna' in body;\n\n  if (\n    !setDayLegacy &&\n    !setNightLegacy &&\n    !setDayOpen &&\n    !setDayClose &&\n    !setNightOpen &&\n    !setNightClose &&\n    // üëÜ we added times, so allow PATCH with only times\n    !('dayOpenTime' in body) &&\n    !('dayCloseTime' in body) &&\n    !('nightOpenTime' in body) &&\n    !('nightCloseTime' in body)\n  ) {\n    return NextResponse.json(\n      {\n        ok: false,\n        error:\n          'Provide at least one of: dayPanna, nightPanna, dayOpenPanna, dayClosePanna, nightOpenPanna, nightClosePanna, or any of the time fields',\n      },\n      { status: 400 }\n    );\n  }\n\n  // ----- legacy day -----\n  if (setDayLegacy) {\n    if (body.dayPanna === null) {\n      round.dayPanna = undefined as any;\n      round.dayDigit = undefined as any;\n    } else {\n      const p = pad3(body.dayPanna);\n      if (!/^\\d{3}$/.test(p)) {\n        return NextResponse.json({ ok: false, error: 'dayPanna must be 000‚Äì999' }, { status: 400 });\n      }\n      round.dayPanna = p;\n      round.dayDigit = digitFromPanna(p);\n    }\n  }\n\n  // ----- legacy night -----\n  if (setNightLegacy) {\n    if (body.nightPanna === null) {\n      round.nightPanna = undefined as any;\n      round.nightDigit = undefined as any;\n    } else {\n      const p = pad3(body.nightPanna);\n      if (!/^\\d{3}$/.test(p)) {\n        return NextResponse.json({ ok: false, error: 'nightPanna must be 000‚Äì999' }, { status: 400 });\n      }\n      round.nightPanna = p;\n      round.nightDigit = digitFromPanna(p);\n    }\n  }\n\n  // ----- DAY OPEN -----\n  if (setDayOpen) {\n    if (body.dayOpenPanna === null) {\n      round.dayOpenPanna = undefined as any;\n      round.dayOpenDigit = undefined as any;\n    } else {\n      const p = pad3(body.dayOpenPanna);\n      if (!/^\\d{3}$/.test(p)) {\n        return NextResponse.json({ ok: false, error: 'dayOpenPanna must be 000‚Äì999' }, { status: 400 });\n      }\n      round.dayOpenPanna = p;\n      round.dayOpenDigit = digitFromPanna(p);\n    }\n  }\n\n  // ----- DAY CLOSE -----\n  if (setDayClose) {\n    if (body.dayClosePanna === null) {\n      round.dayClosePanna = undefined as any;\n      round.dayCloseDigit = undefined as any;\n    } else {\n      const p = pad3(body.dayClosePanna);\n      if (!/^\\d{3}$/.test(p)) {\n        return NextResponse.json({ ok: false, error: 'dayClosePanna must be 000‚Äì999' }, { status: 400 });\n      }\n      round.dayClosePanna = p;\n      round.dayCloseDigit = digitFromPanna(p);\n    }\n  }\n\n  // ----- NIGHT OPEN -----\n  if (setNightOpen) {\n    if (body.nightOpenPanna === null) {\n      round.nightOpenPanna = undefined as any;\n      round.nightOpenDigit = undefined as any;\n    } else {\n      const p = pad3(body.nightOpenPanna);\n      if (!/^\\d{3}$/.test(p)) {\n        return NextResponse.json({ ok: false, error: 'nightOpenPanna must be 000‚Äì999' }, { status: 400 });\n      }\n      round.nightOpenPanna = p;\n      round.nightOpenDigit = digitFromPanna(p);\n    }\n  }\n\n  // ----- NIGHT CLOSE -----\n  if (setNightClose) {\n    if (body.nightClosePanna === null) {\n      round.nightClosePanna = undefined as any;\n      round.nightCloseDigit = undefined as any;\n    } else {\n      const p = pad3(body.nightClosePanna);\n      if (!/^\\d{3}$/.test(p)) {\n        return NextResponse.json({ ok: false, error: 'nightClosePanna must be 000‚Äì999' }, { status: 400 });\n      }\n      round.nightClosePanna = p;\n      round.nightCloseDigit = digitFromPanna(p);\n    }\n  }\n\n  // recompute day line\n  const haveDayOpen  = round.dayOpenDigit != null;\n  const haveDayClose = round.dayCloseDigit != null;\n  if (haveDayOpen && haveDayClose) {\n    round.dayJodi = deriveJodi(round.dayOpenDigit!, round.dayCloseDigit!) as string;\n    // @ts-ignore\n    round.dayLineStatus = 'CLOSED';\n  } else if (haveDayOpen) {\n    // @ts-ignore\n    round.dayLineStatus = 'OPEN_PUBLISHED';\n    round.dayJodi = undefined;\n  } else {\n    // @ts-ignore\n    round.dayLineStatus = 'READY';\n    round.dayJodi = undefined;\n  }\n\n  // recompute night line\n  const haveNightOpen2  = round.nightOpenDigit != null;\n  const haveNightClose2 = round.nightCloseDigit != null;\n  if (haveNightOpen2 && haveNightClose2) {\n    round.nightJodi = deriveJodi(round.nightOpenDigit!, round.nightCloseDigit!) as string;\n    // @ts-ignore\n    round.nightLineStatus = 'CLOSED';\n  } else if (haveNightOpen2) {\n    // @ts-ignore\n    round.nightLineStatus = 'OPEN_PUBLISHED';\n    round.nightJodi = undefined;\n  } else {\n    // @ts-ignore\n    round.nightLineStatus = 'READY';\n    round.nightJodi = undefined;\n  }\n\n  await round.save();\n\n  return NextResponse.json({ ok: true, round });\n}\n// ------------------ NEW: DELETE ------------------\nexport async function DELETE(req: Request) {\n  const sessionDate = extractSessionDate(req);\n  if (!sessionDate) {\n    return NextResponse.json(\n      { ok: false, error: 'Bad sessionDate in URL' },\n      { status: 400 }\n    );\n  }\n\n  await dbConnect();\n\n  // find the round first (so we can also delete bets that point to it)\n  const round = await Round.findOne({ sessionDate });\n  if (!round) {\n    // UI will show ‚ÄúDeleted successfully!‚Äù if we just return ok\n    return NextResponse.json({ ok: true, note: 'Round not found (already deleted?)' });\n  }\n\n  // delete bets for that round (optional but nice to keep DB clean)\n  await Bet.deleteMany({ round: round._id });\n\n  // delete the round itself\n  await Round.deleteOne({ _id: round._id });\n\n  return NextResponse.json({ ok: true });\n}"],"names":[],"mappings":"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","debugId":null}}]
}